# =============================================================================
# 프로덕션 환경 변수 템플릿
# =============================================================================
# 이 파일을 .env.production으로 복사하고 실제 값으로 채워주세요
# 절대 실제 .env 파일을 git에 커밋하지 마세요!
# =============================================================================

# -----------------------------------------------------------------------------
# Application Configuration
# -----------------------------------------------------------------------------
NODE_ENV=production
PORT=3000
APP_NAME=gonsai2
APP_URL=https://yourdomain.com

# -----------------------------------------------------------------------------
# n8n Configuration
# -----------------------------------------------------------------------------
# n8n API 접근 정보
N8N_API_URL=http://localhost:5678
N8N_WEBHOOK_URL=https://yourdomain.com/webhook
N8N_API_KEY=your-n8n-api-key-here

# n8n 도메인 설정
N8N_HOST=n8n.yourdomain.com
N8N_PROTOCOL=https
N8N_PORT=5678

# n8n 암호화 키 (절대 변경하지 마세요! 한번 설정하면 영구적입니다)
N8N_ENCRYPTION_KEY=your-32-char-encryption-key-here
N8N_JWT_SECRET=your-jwt-secret-here

# n8n 실행 설정
EXECUTIONS_MODE=queue
EXECUTIONS_DATA_MAX_AGE=336
EXECUTIONS_DATA_PRUNE=true

# -----------------------------------------------------------------------------
# Database Configuration - PostgreSQL (n8n)
# -----------------------------------------------------------------------------
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=n8n
POSTGRES_USER=n8n
POSTGRES_PASSWORD=your-secure-postgres-password-here

# PostgreSQL 성능 튜닝
POSTGRES_MAX_CONNECTIONS=100
POSTGRES_SHARED_BUFFERS=256MB
POSTGRES_EFFECTIVE_CACHE_SIZE=1GB

# -----------------------------------------------------------------------------
# Database Configuration - MongoDB (Application)
# -----------------------------------------------------------------------------
MONGO_ROOT_USER=admin
MONGO_ROOT_PASSWORD=your-secure-mongo-password-here
MONGO_DATABASE=gonsai2
MONGO_AUTH_SOURCE=admin

# MongoDB URI (애플리케이션용)
MONGODB_URI=mongodb://admin:your-secure-mongo-password-here@mongodb:27017/gonsai2?authSource=admin

# -----------------------------------------------------------------------------
# Redis Configuration (Cache & Queue)
# -----------------------------------------------------------------------------
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=your-secure-redis-password-here
REDIS_DB=0
REDIS_URL=redis://:your-secure-redis-password-here@redis:6379/0

# Redis 메모리 설정
REDIS_MAX_MEMORY=2gb
REDIS_MAX_MEMORY_POLICY=allkeys-lru

# -----------------------------------------------------------------------------
# Security & Authentication
# -----------------------------------------------------------------------------
# JWT 설정
JWT_SECRET=your-long-random-jwt-secret-min-32-chars
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# 암호화 키
ENCRYPTION_KEY=your-32-byte-encryption-key-for-sensitive-data

# Session 설정
SESSION_SECRET=your-session-secret-here
SESSION_MAX_AGE=604800000

# CORS 설정
CORS_ORIGIN=https://yourdomain.com,https://www.yourdomain.com

# -----------------------------------------------------------------------------
# Monitoring & Observability - Prometheus
# -----------------------------------------------------------------------------
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION_TIME=30d

# -----------------------------------------------------------------------------
# Monitoring & Observability - Grafana
# -----------------------------------------------------------------------------
GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=your-secure-grafana-password-here
GRAFANA_ROOT_URL=https://grafana.yourdomain.com
GRAFANA_SMTP_ENABLED=false
GRAFANA_SMTP_HOST=smtp.gmail.com:587
GRAFANA_SMTP_USER=your-email@gmail.com
GRAFANA_SMTP_PASSWORD=your-smtp-password

# -----------------------------------------------------------------------------
# Logging - Loki
# -----------------------------------------------------------------------------
LOKI_PORT=3100
LOKI_RETENTION_PERIOD=720h

# -----------------------------------------------------------------------------
# Alerting - Alertmanager
# -----------------------------------------------------------------------------
ALERTMANAGER_PORT=9093
ALERT_EMAIL_TO=alerts@yourdomain.com
ALERT_EMAIL_FROM=noreply@yourdomain.com
ALERT_SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK

# -----------------------------------------------------------------------------
# SSL/TLS Configuration
# -----------------------------------------------------------------------------
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem
SSL_DHPARAM_PATH=/etc/nginx/ssl/dhparam.pem

# Let's Encrypt
LETSENCRYPT_EMAIL=admin@yourdomain.com
LETSENCRYPT_DOMAIN=yourdomain.com

# -----------------------------------------------------------------------------
# Backup Configuration
# -----------------------------------------------------------------------------
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=your-backup-bucket
BACKUP_S3_REGION=ap-northeast-2
BACKUP_S3_ACCESS_KEY=your-s3-access-key
BACKUP_S3_SECRET_KEY=your-s3-secret-key

# -----------------------------------------------------------------------------
# Email Configuration
# -----------------------------------------------------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-specific-password
EMAIL_FROM=noreply@yourdomain.com

# -----------------------------------------------------------------------------
# Timezone
# -----------------------------------------------------------------------------
TIMEZONE=Asia/Seoul
TZ=Asia/Seoul

# -----------------------------------------------------------------------------
# Resource Limits
# -----------------------------------------------------------------------------
# CPU/Memory limits are defined in docker-compose.yml
# These are application-level limits

# Node.js 메모리 제한
NODE_OPTIONS=--max-old-space-size=2048

# Worker 프로세스 수
WEB_CONCURRENCY=2

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
ENABLE_METRICS=true
ENABLE_TRACING=false
ENABLE_DEBUG_LOGS=false
ENABLE_API_DOCS=true

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# File Upload
# -----------------------------------------------------------------------------
MAX_FILE_SIZE=10485760
UPLOAD_DIR=/tmp/uploads

# -----------------------------------------------------------------------------
# Cache Configuration
# -----------------------------------------------------------------------------
CACHE_TTL=3600
CACHE_MAX_ITEMS=1000

# -----------------------------------------------------------------------------
# Webhook Configuration
# -----------------------------------------------------------------------------
WEBHOOK_TIMEOUT=30000
WEBHOOK_MAX_PAYLOAD_SIZE=5242880

# -----------------------------------------------------------------------------
# Worker Configuration
# -----------------------------------------------------------------------------
WORKER_CONCURRENCY=10
WORKER_MAX_JOBS_PER_WORKER=50

# -----------------------------------------------------------------------------
# Health Check Configuration
# -----------------------------------------------------------------------------
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3

# -----------------------------------------------------------------------------
# Development/Debug (프로덕션에서는 false로 설정)
# -----------------------------------------------------------------------------
DEBUG=false
VERBOSE_LOGGING=false
STACK_TRACE_LIMIT=10
