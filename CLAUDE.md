# CLAUDE.md - gonsai2 프로젝트 가이드

이 문서는 Claude Code가 gonsai2 프로젝트에서 작업할 때 참고하는 가이드입니다.

---

## 📋 Issue 처리 표준 프로세스

### 개요

모든 버그, 오류, 개선사항은 아래의 표준화된 프로세스를 통해 GitHub Issue로 문서화됩니다.

### 처리 단계

- 답변은 항상 한글사용

#### 1단계: 문제 진단 및 해결

- **오류 증상 확인**: 브라우저 콘솔, 서버 로그, 네트워크 요청 등 모든 관련 로그 수집
- **근본 원인 분석**: 표면적 증상이 아닌 근본 원인 파악 (예: 프로토콜 불일치, 설정 오류, 코드 로직 오류)
- **코드 수정**: 근본 원인을 해결하는 코드 변경 적용
- **검증**: 수정 사항이 문제를 완전히 해결했는지 테스트

#### 2단계: GitHub 이슈 생성

**이슈 제목 형식**:

```
fix: [간단한 문제 설명]
```

**이슈 본문 구성**:

```markdown
## 🐛 문제 설명

[오류 증상 및 재현 방법]

### 오류 증상

- 브라우저/서버 오류 메시지
- 비정상 동작 설명
- 영향 범위

## 🔍 근본 원인

**[원인 카테고리]**

1. **상세 원인 1**: [설명]
2. **상세 원인 2**: [설명]

→ **결과**: [문제가 발생한 이유 요약]

## ✅ 해결 방법

### 1. [수정 항목 1]

**파일**: `path/to/file`

\`\`\`diff

- 변경 전 코드

* 변경 후 코드
  \`\`\`

### 2. [수정 항목 2]

**파일**: `path/to/file`

\`\`\`diff

- 변경 전 코드

* 변경 후 코드
  \`\`\`

**변경 이유**: [왜 이렇게 수정했는지 설명]

## 📊 기술적 배경

### [관련 기술/개념 설명]

[필요시 기술 비교 표, 아키텍처 설명 등 추가]

## 🧪 테스트 결과

**검증 방법**:
\`\`\`bash

# 테스트 커맨드

\`\`\`

**결과**: ✅ 성공 / ❌ 실패

## 📁 관련 파일

- `path/to/file1` - [역할]
- `path/to/file2` - [역할]

## 💡 교훈

1. **교훈 1**: [배운 점]
2. **교훈 2**: [향후 주의사항]

---

**상태**: ✅ 해결 완료
**테스트**: ✅ 검증 완료
```

**라벨 사용**:

- `bug` (필수)
- 저장소에 존재하는 라벨만 사용
- 존재하지 않는 라벨은 사용하지 않음

#### 3단계: 처리 과정 코멘트 추가

이슈에 다음 형식의 코멘트를 추가:

```markdown
## 🔧 처리 과정

### 1단계: 문제 진단

\`\`\`bash

# 진단 커맨드 및 결과

\`\`\`

**발견사항**: [진단 결과]

### 2단계: 코드 분석

\`\`\`bash

# 코드 분석 내용

\`\`\`

**발견사항**: [분석 결과]

### 3단계: 수정 작업

**파일 1**: `path/to/file`
\`\`\`typescript
// 변경 내용
\`\`\`

### 4단계: 검증

\`\`\`bash

# 검증 커맨드

\`\`\`

**결과**: ✅ [검증 성공]

### 5단계: 최종 결과

- ✅ [완료 항목 1]
- ✅ [완료 항목 2]

---

**처리 시간**: 약 X분
**수정 파일 수**: N개
**테스트 결과**: 모든 기능 정상 동작 확인
```

#### 4단계: 이슈 종료

최종 상태 확인 후 이슈 클로즈:

```markdown
이슈가 성공적으로 해결되었습니다.

**최종 상태**: ✅ 모든 기능 정상 동작 확인

**변경 사항**:

1. [변경 1]
2. [변경 2]

**테스트 완료**:

- ✅ [테스트 항목 1]
- ✅ [테스트 항목 2]

문제가 완전히 해결되어 이슈를 종료합니다.
```

### 예시: 실제 이슈

참고: [#2 - Monitoring 페이지 WebSocket 연결 오류](https://github.com/krdn/gonsai2/issues/2)

---

## 🏗️ 프로젝트 구조

```
gonsai2/
├── apps/
│   ├── backend/          # Express + TypeScript 백엔드
│   │   └── src/
│   │       ├── services/     # 비즈니스 로직
│   │       ├── routes/       # API 라우트
│   │       └── utils/        # 유틸리티
│   └── frontend/         # Next.js + TypeScript 프론트엔드
│       └── src/
│           ├── app/          # App Router 페이지
│           ├── components/   # React 컴포넌트
│           └── lib/          # 유틸리티 라이브러리
└── features/            # 기능별 모듈
    ├── error-healing/
    ├── agent-orchestration/
    └── monitoring/
```

---

## 🔧 개발 환경 설정

### 백엔드 서버

```bash
cd /home/gon/projects/gonsai2
npm run server:dev
```

### 프론트엔드 개발 서버

```bash
cd /home/gon/projects/gonsai2/apps/frontend
npx next dev -p 3002
```

### 환경 변수

- **Backend**: `.env` (MongoDB URI, n8n API 키)
- **Frontend**: `apps/frontend/.env.local` (API URL, WebSocket URL)

---

## 📚 주요 기술 스택

- **Backend**: Node.js, Express, TypeScript, MongoDB
- **Frontend**: Next.js 14, React, TypeScript, Tailwind CSS
- **WebSocket**: Native WebSocket (ws 라이브러리)
- **n8n Integration**: REST API + WebSocket

---

## ✅ 품질 기준

### 코드 품질

- TypeScript strict mode 준수
- ESLint 규칙 준수
- 명확한 변수/함수 네이밍

### 문서화

- 모든 이슈는 GitHub Issue로 문서화
- 주요 변경사항은 코멘트로 이유 설명
- README 파일 최신 상태 유지

### 테스트

- 수정 후 반드시 동작 검증
- 브라우저 콘솔 오류 확인
- 서버 로그 정상 작동 확인

---

**생성일**: 2025-01-12
**최종 수정**: 2025-01-12
